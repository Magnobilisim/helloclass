import{c as R,u as q,d as W,r as u,j as e,o as U,e as G}from"./index-0u4Oh89o.js";import{C as O}from"./clock-BvtiLr35.js";import{T as P}from"./timer-BRimZ0KE.js";import{T as d}from"./trophy-CgD_h7Om.js";import{C}from"./circle-check-big-2iAip2ib.js";import{A as H}from"./arrow-right-CDCFAQgN.js";import{L as J}from"./loader-circle-Dfq5PCOO.js";import{C as K}from"./circle-play-C8xoM4uo.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],X=R("coins",V),le=()=>{var k,L;const{user:i,prizeExams:x,exams:Y,results:S,t,showAlert:m,updateUser:$,payEntryFee:D}=q(),h=W(),T="/student/shop",b=()=>m(t("not_enough_points"),"error",{actionLabel:t("go_to_shop_cta"),actionTo:T}),[l,j]=u.useState(null),[g,y]=u.useState(!1),N=new Date().toISOString().slice(0,7),r=x.find(s=>s.isActive&&s.month===N&&(i!=null&&i.classLevel?s.grade===i.classLevel:!0)),I=x.filter(s=>!s.isActive||s.month!==N).sort((s,a)=>a.month.localeCompare(s.month)),w=x.filter(s=>s.finalists&&s.finalists.length>0),v=Date.now(),f=w.filter(s=>s.finalistQuizDate?new Date(s.finalistQuizDate).getTime()>=v:!0),p=w.filter(s=>s.finalistQuizDate?new Date(s.finalistQuizDate).getTime()<v:!1),_=(s,a=!1)=>e.jsxs("div",{className:"bg-white p-5 rounded-3xl border border-indigo-100 shadow-sm",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-[10px] text-gray-400 font-bold uppercase tracking-wider",children:[s.month," • ",t("grade")," ",s.grade]}),e.jsx("h4",{className:"text-lg font-black text-gray-900",children:s.prizeTitle})]}),s.finalistQuizDate&&e.jsx("div",{className:`text-sm font-bold px-3 py-1 rounded-xl ${a?"text-gray-500 bg-gray-100":"text-indigo-600 bg-indigo-50"}`,children:t("prize_finalist_quiz_date").replace("{date}",new Date(s.finalistQuizDate).toLocaleString())})]}),s.finalistQuizLink&&e.jsx("a",{href:s.finalistQuizLink,target:"_blank",rel:"noreferrer",className:`inline-flex items-center gap-2 text-xs font-bold underline mb-3 ${a?"text-gray-500":"text-indigo-600"}`,children:t("prize_finalist_quiz_link")}),e.jsx("div",{className:"space-y-2",children:(s.finalists||[]).map(n=>e.jsxs("div",{className:"bg-gray-50 border border-gray-100 rounded-xl p-3 flex justify-between items-center text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-bold text-gray-900",children:n.name}),e.jsx("p",{className:"text-xs text-gray-500 font-semibold",children:[n.schoolName,n.classLevel?`${n.classLevel}. ${t("grade")}`:null].filter(Boolean).join(" • ")})]}),e.jsx("div",{className:"text-xs font-bold text-gray-400 uppercase",children:t("finalist")})]},`${s.id}-${n.userId}`))})]},`${s.id}-${a?"past":"upcoming"}`),c=r?S.find(s=>s.examId===r.examId&&s.studentId===(i==null?void 0:i.id)):null,z=!!c;u.useEffect(()=>{if(!r)return;const s=()=>{const[n,M]=r.month.split("-").map(Number),E=new Date(n,M,1).getTime()-1,B=new Date().getTime(),o=E-B;return o>0?{days:Math.floor(o/(1e3*60*60*24)),hours:Math.floor(o/(1e3*60*60)%24),minutes:Math.floor(o/1e3/60%60),seconds:Math.floor(o/1e3%60)}:null};j(s());const a=setInterval(()=>{j(s())},1e3);return()=>clearInterval(a)},[r]);const A=()=>{var s;if(i){if(z){m(t("already_taken_contest"),"warning");return}r&&(r.entryFee>0?(s=r.participants)!=null&&s.includes(i.id)?h(`/student/exam/${r.examId}`):i.points>=r.entryFee&&D(r.id,r.entryFee)?h(`/student/exam/${r.examId}`):b():h(`/student/exam/${r.examId}`))}},F=()=>{i&&(y(!0),setTimeout(()=>{y(!1),$({...i,points:i.points+50}),m(t("ad_reward"),"success")},3e3))},Q=i?i.points>=((r==null?void 0:r.entryFee)||0):!1;return e.jsxs("div",{className:"space-y-8 pb-20 animate-fade-in",children:[e.jsxs("header",{className:"bg-gradient-to-r from-pink-500 to-rose-500 p-8 rounded-3xl text-white shadow-lg relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white opacity-10 rounded-full translate-x-20 -translate-y-20"}),e.jsx(U,{size:64,className:"absolute bottom-4 right-4 text-white opacity-20 rotate-12"}),e.jsx("h2",{className:"text-3xl font-black mb-2 relative z-10",children:t("prize_exams")}),e.jsx("p",{className:"text-pink-100 font-medium relative z-10",children:t("prize_exams_desc")})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(O,{className:"text-brand-500"})," ",t("active_contest")]}),r?e.jsxs("div",{className:"bg-white rounded-[2.5rem] border-4 border-pink-50 overflow-hidden shadow-2xl flex flex-col md:flex-row relative group",children:[l&&e.jsxs("div",{className:"absolute top-4 right-4 md:left-4 md:right-auto bg-gray-900/90 backdrop-blur text-white px-4 py-2 rounded-2xl font-mono font-bold text-sm shadow-lg z-20 flex items-center gap-2 border border-gray-700",children:[e.jsx(P,{size:16,className:"text-pink-400"}),e.jsxs("span",{children:[l.days,t("days")," ",String(l.hours).padStart(2,"0"),t("hours")," ",String(l.minutes).padStart(2,"0"),t("minutes")," ",String(l.seconds).padStart(2,"0"),t("seconds")]})]}),e.jsxs("div",{className:"md:w-2/5 h-72 md:h-auto relative bg-gray-50 overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent z-10"}),e.jsx("img",{src:r.prizeImage,className:"w-full h-full object-contain md:object-cover bg-white transition-transform duration-700 group-hover:scale-105",style:{imageRendering:"auto"},alt:r.prizeTitle}),e.jsxs("div",{className:"absolute bottom-6 left-6 z-20 text-white drop-shadow-lg",children:[e.jsxs("span",{className:"bg-pink-500 text-white text-[10px] font-black px-2 py-1 rounded mb-2 inline-block uppercase tracking-wider shadow-sm",children:[t("grade")," ",r.grade]}),e.jsx("h3",{className:"text-2xl font-black leading-tight",children:r.prizeTitle})]})]}),e.jsxs("div",{className:"p-8 flex-1 flex flex-col justify-center relative",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-2",children:t("contest_description")}),e.jsx("p",{className:"text-gray-600 leading-relaxed text-sm",children:r.prizeDescription}),r.entryFee>0&&e.jsxs("div",{className:"mt-4 flex items-center gap-2 font-bold text-yellow-600 bg-yellow-50 px-3 py-1.5 rounded-lg w-fit border border-yellow-100",children:[e.jsx(X,{size:16})," ",t("entry_fee"),": ",r.entryFee," ",t("points")]})]}),z?e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 p-6 rounded-3xl border border-green-100 flex flex-col items-center text-center space-y-3",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center text-green-600 mb-2",children:e.jsx(d,{size:32})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-black text-green-800",children:t("exam_completed_status")}),e.jsx("p",{className:"text-green-600 text-sm font-medium",children:t("in_the_draw")})]}),e.jsxs("div",{className:"bg-white px-6 py-2 rounded-xl shadow-sm border border-green-100 flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-400 text-xs font-bold uppercase",children:t("score")}),e.jsx("span",{className:"text-2xl font-black text-gray-800",children:c==null?void 0:c.score})]}),e.jsx("p",{className:"text-xs text-green-700/60 font-bold mt-2 animate-pulse",children:t("winner_announced_soon")})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-xl mb-6 border border-gray-100",children:[e.jsx("h4",{className:"font-bold text-gray-700 mb-2 text-xs uppercase tracking-wider",children:t("contest_rules")}),e.jsxs("ul",{className:"space-y-2 text-xs text-gray-600 font-medium",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(C,{size:14,className:"text-pink-500"})," ",t("contest_rule_1")]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx(C,{size:14,className:"text-pink-500"})," ",t("contest_rule_2")]})]})]}),Q||(k=r.participants)!=null&&k.includes((i==null?void 0:i.id)||"")?e.jsxs("button",{onClick:A,className:"w-full bg-gray-900 text-white py-4 rounded-2xl font-black text-lg hover:scale-[1.02] transition-transform shadow-xl shadow-gray-200 flex items-center justify-center gap-2 group/btn",children:[r.entryFee>0&&!((L=r.participants)!=null&&L.includes((i==null?void 0:i.id)||""))?t("pay_and_enter"):t("contest_enter")," ",e.jsx(H,{size:20,className:"group-hover/btn:translate-x-1 transition-transform"})]}):e.jsxs("button",{onClick:F,disabled:g,className:"w-full bg-yellow-500 text-white py-4 rounded-2xl font-black text-lg hover:scale-[1.02] transition-transform shadow-xl shadow-yellow-200 flex items-center justify-center gap-2 group/btn",children:[g?e.jsx(J,{className:"animate-spin"}):e.jsx(K,{size:24}),g?t("watching_ad"):`${t("watch_ad")} (+50 ${t("points")})`]})]})]})]}):e.jsxs("div",{className:"bg-white p-12 rounded-3xl border border-dashed border-gray-200 text-center text-gray-400",children:[e.jsx(d,{size:48,className:"mx-auto mb-4 opacity-30"}),e.jsx("p",{children:t("no_active_contest").replace("{grade}",String((i==null?void 0:i.classLevel)||"?"))})]})]}),(f.length>0||p.length>0)&&e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(d,{className:"text-indigo-500"})," ",t("prize_finalists_title")]}),f.length>0&&e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("p",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider",children:t("prize_finalists_upcoming")}),f.map(s=>_(s))]}),p.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-xs font-bold text-gray-400 uppercase tracking-wider",children:t("prize_finalists_past")}),p.map(s=>_(s,!0))]})]}),e.jsxs("section",{children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-800 mb-6 flex items-center gap-2",children:[e.jsx(G,{className:"text-yellow-500"})," ",t("hall_of_fame")]}),(()=>{const s=I.filter(a=>a.winnerName||a.finalists&&a.finalists.length);return s.length===0?e.jsx("div",{className:"py-12 text-center bg-gray-50 rounded-3xl border border-gray-100",children:e.jsx("p",{className:"text-gray-400 text-sm font-medium italic",children:t("no_past_winners")})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5",children:s.map(a=>e.jsxs("div",{className:"bg-white p-5 rounded-[2rem] border border-gray-100 shadow-sm hover:shadow-md transition-shadow relative overflow-hidden space-y-4",children:[e.jsx("div",{className:"absolute top-0 right-0 p-4 opacity-5",children:e.jsx(d,{size:64})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative w-20 h-20 shrink-0",children:[e.jsx("img",{src:a.prizeImage,className:"w-full h-full rounded-2xl object-cover bg-gray-100 shadow-inner"}),e.jsx("div",{className:"absolute -bottom-2 -right-2 bg-yellow-400 text-white p-1.5 rounded-full shadow-sm border-2 border-white",children:e.jsx(d,{size:14})})]}),e.jsxs("div",{className:"flex-1 min-w-0 relative z-10",children:[e.jsxs("div",{className:"text-[10px] text-gray-400 font-bold uppercase mb-1 tracking-wider",children:[a.month," • ",t("grade")," ",a.grade]}),e.jsx("div",{className:"font-black text-gray-900 text-lg truncate",children:a.prizeTitle}),e.jsxs("div",{className:"text-xs text-brand-600 font-bold truncate",children:[t("won_prize_prefix")," ",a.prizeTitle]})]})]}),a.winnerName&&e.jsxs("div",{className:"bg-green-50 border border-green-100 rounded-2xl p-4",children:[e.jsx("p",{className:"text-[10px] font-bold text-green-600 uppercase tracking-wider mb-1",children:t("winner")}),e.jsx("div",{className:"text-lg font-black text-gray-900",children:a.winnerName}),(a.winnerSchool||a.winnerClassLevel)&&e.jsx("div",{className:"text-xs text-gray-500 font-bold mt-1",children:[a.winnerSchool,a.winnerClassLevel?`${a.winnerClassLevel}. ${t("grade")}`:null].filter(Boolean).join(" • ")})]}),a.finalists&&a.finalists.length>0&&e.jsxs("div",{className:"bg-gray-50 border border-gray-100 rounded-2xl p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] font-bold text-gray-500 uppercase tracking-wider",children:t("prize_finalists_title")}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:a.finalistNote||t("prize_finalists_note")}),a.finalistQuizDate&&e.jsx("p",{className:"text-xs font-bold text-indigo-600 mt-1",children:t("prize_finalist_quiz_date").replace("{date}",new Date(a.finalistQuizDate).toLocaleString())})]}),e.jsx("div",{className:"space-y-2",children:a.finalists.map(n=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-100 p-3",children:[e.jsx("div",{className:"font-bold text-gray-900",children:n.name}),(n.schoolName||n.classLevel)&&e.jsx("div",{className:"text-xs text-gray-500 font-semibold",children:[n.schoolName,n.classLevel?`${n.classLevel}. ${t("grade")}`:null].filter(Boolean).join(" • ")})]},`${a.id}-${n.userId}`))})]})]},a.id))})})()]})]})};export{le as StudentPrizeExams};
