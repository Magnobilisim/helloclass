import{c as N,u as M,a as P,r as n,j as e,L as F,l as H,e as B}from"./index-BaVKQqDK.js";import{P as K}from"./play-GRDGK8LR.js";import{C as O}from"./circle-alert-URQLJeUd.js";import{C as Q}from"./circle-check-big-CKswuTQY.js";import{A as U}from"./arrow-right-D3H4TVfT.js";/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],S=N("award",q);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],V=N("calendar",G);/**
 * @license lucide-react v0.554.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],J=N("circle-x",X),se=({studentId:p})=>{const{results:z,user:d,exams:b,t:s,availableSubjects:C}=M(),w=P(),[g,h]=n.useState(null),[j,I]=n.useState("all"),[u,$]=n.useState(null),v=n.useRef({}),m=n.useRef(null),f=p||(d==null?void 0:d.id),E=!p,i=z.filter(t=>t.studentId===f).sort((t,a)=>new Date(a.date).getTime()-new Date(t.date).getTime()),A=n.useMemo(()=>{const t=new Map;return i.forEach(a=>{const o=b.find(c=>c.id===a.examId);o&&t.set(o.id,o.title)}),Array.from(t.entries()).map(([a,o])=>({value:a,label:o}))},[i,b]),L=j==="all"?i:i.filter(t=>t.examId===j),_=(d==null?void 0:d.id)===f;return n.useEffect(()=>{if(!f||p){h(null);return}const a=new URLSearchParams(w.search).get("highlight");return a?(h(a),m.current&&clearTimeout(m.current),m.current=setTimeout(()=>h(null),5e3)):h(null),()=>{m.current&&clearTimeout(m.current)}},[w.search,f,p]),n.useEffect(()=>{var a;if(!g)return;const t=v.current[g];t&&(t.scrollIntoView({behavior:"smooth",block:"center"}),(a=t.focus)==null||a.call(t))},[g,i.length]),e.jsxs("div",{className:"space-y-6 animate-fade-in pb-10",children:[e.jsxs("header",{className:"flex items-center justify-between",children:[e.jsxs("h2",{className:"text-3xl font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(S,{className:"text-brand-500"})," ",s("results_history")]}),e.jsxs("div",{className:"text-sm font-bold text-gray-500 bg-gray-100 px-3 py-1 rounded-lg",children:[s("total"),": ",i.length]})]}),i.length===0?e.jsxs("div",{className:"bg-white p-12 rounded-3xl shadow-sm border border-gray-100 text-center flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-purple-50 rounded-full flex items-center justify-center mb-6 animate-pulse",children:e.jsx(S,{size:48,className:"text-purple-300"})}),e.jsx("h3",{className:"text-2xl font-black text-gray-800 mb-2",children:s("no_results_yet")}),e.jsx("p",{className:"text-gray-500 mb-8 max-w-sm",children:s(_?"no_results_desc_own":"no_results_desc_other")}),_&&e.jsxs(F,{to:"/student/exams",className:"bg-gradient-to-r from-brand-500 to-orange-500 text-white px-8 py-4 rounded-2xl font-bold shadow-xl shadow-brand-200 hover:scale-105 transition-transform flex items-center gap-2",children:[e.jsx(K,{size:20,fill:"currentColor"})," ",s("go_to_market")]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-3xl border border-gray-100 p-4 shadow-sm flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[e.jsxs("div",{className:"flex flex-col flex-1 gap-1",children:[e.jsx("span",{className:"text-xs font-bold text-gray-400 uppercase",children:s("filter_label")||"Filtrele"}),e.jsx("p",{className:"text-sm text-gray-600",children:s("filter_hint")||"Sınav sonuçlarını derli toplu görmek için seç."})]}),e.jsxs("select",{value:j,onChange:t=>I(t.target.value),className:"w-full sm:w-64 bg-gray-50 border border-gray-200 rounded-2xl px-4 py-2.5 font-semibold text-sm text-gray-800 focus:border-brand-500 focus:bg-white transition-colors",children:[e.jsx("option",{value:"all",children:s("all_exams")||"Tüm sınavlar"}),A.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-4",children:L.map(t=>{var R;const a=b.find(l=>l.id===t.examId),c=Math.round(t.score/t.totalQuestions*100)>=50,k=!a,T=a?(R=C.find(l=>l.id===a.subjectId))==null?void 0:R.name:"Unknown",x=t.learningReportStatus,r=t.learningReport,D=g===t.id;return e.jsxs("div",{ref:l=>{v.current[t.id]=l},className:`bg-white p-5 rounded-3xl shadow-sm border flex flex-col hover:shadow-md transition-all relative overflow-hidden group ${D?"border-brand-500 ring-2 ring-brand-400 animate-pulse":"border-gray-100"}`,children:[e.jsx("div",{className:`absolute top-0 left-0 w-2 h-full ${c?"bg-green-500":"bg-red-500"}`}),e.jsx("div",{className:"flex justify-between items-start mb-3 pl-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1 flex-wrap",children:[k?e.jsxs("span",{className:"bg-gray-100 text-gray-500 text-[10px] font-bold px-2 py-0.5 rounded flex items-center gap-1",children:[e.jsx(O,{size:10})," ",s("deleted_exam")]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"bg-brand-50 text-brand-700 text-[10px] font-bold px-2 py-0.5 rounded border border-brand-100",children:T}),a.topic&&e.jsxs("span",{className:"bg-blue-50 text-blue-700 text-[10px] font-bold px-2 py-0.5 rounded border border-blue-100 flex items-center gap-1",children:[e.jsx(H,{size:8})," ",a.topic]})]}),e.jsxs("span",{className:"text-[10px] text-gray-400 font-medium flex items-center gap-1",children:[e.jsx(V,{size:10})," ",new Date(t.date).toLocaleDateString()]})]}),e.jsx("h4",{className:`font-bold text-gray-800 text-lg leading-tight line-clamp-1 ${k?"text-gray-400 italic":""}`,children:(a==null?void 0:a.title)||s("unknown_exam")})]})}),e.jsxs("div",{className:"flex items-end justify-between pl-4 mt-2",children:[e.jsxs("div",{children:[e.jsxs("div",{className:`flex items-center gap-1.5 font-bold text-sm mb-1 ${c?"text-green-600":"text-red-500"}`,children:[c?e.jsx(Q,{size:16}):e.jsx(J,{size:16}),s(c?"passed":"failed")]}),e.jsxs("div",{className:"flex items-center gap-1 text-xs font-bold text-yellow-500 bg-yellow-50 px-2 py-1 rounded-lg w-fit",children:[e.jsx(B,{size:12,fill:"currentColor"})," +",t.rewardsEarned," ",s("points")]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-3xl font-black text-gray-800 tracking-tighter",children:[e.jsx("span",{className:c?"text-brand-600":"text-gray-400",children:t.score}),e.jsxs("span",{className:"text-gray-300 text-xl",children:["/",t.totalQuestions]})]})})]}),E&&(x||r)&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-50 pl-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest",children:s("learning_outcomes_title")}),x==="ready"&&r&&e.jsxs("button",{onClick:()=>$(l=>l===t.id?null:t.id),className:"text-xs font-bold text-brand-600 flex items-center gap-1",children:[u===t.id?s("collapse")||"Kapat":s("expand")||"Göster"," ",e.jsx(U,{size:12,className:`${u===t.id?"transform rotate-90":""}`})]})]}),x==="pending"&&e.jsx("p",{className:"text-xs text-gray-500",children:s("learning_outcomes_pending")}),x==="failed"&&e.jsx("p",{className:"text-xs text-red-500",children:s("learning_outcomes_error")}),x==="ready"&&r&&u===t.id&&e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsx("p",{children:r.summary}),r.outcomes.length>0&&e.jsx("ul",{className:"space-y-1.5 list-disc pl-4",children:r.outcomes.map((l,y)=>e.jsx("li",{children:l},`lr-${t.id}-${y}`))}),r.focusAreas.length>0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-[11px] font-bold text-gray-400 uppercase tracking-widest mt-2",children:s("learning_outcomes_focus_title")}),e.jsx("ul",{className:"space-y-1.5 text-sm text-gray-600 list-disc pl-4",children:r.focusAreas.map((l,y)=>e.jsx("li",{children:l},`focus-${t.id}-${y}`))})]})]}),x==="ready"&&r&&u!==t.id&&e.jsx("p",{className:"text-xs text-gray-500",children:s("learning_outcomes_preview")||"Kazanımları görmek için aç."})]})]},t.id)})})]})]})};export{se as StudentResults};
